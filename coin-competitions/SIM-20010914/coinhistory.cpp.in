/**************************************************************************\
 *
 *  This file is part of a set of demo programs for the Coin library.
 *  Copyright (C) 2000-2001 by Systems in Motion. All rights reserved.
 *
 *  This sourcecode can be redistributed and/or modified under the
 *  terms of the GNU General Public License version 2 as published by
 *  the Free Software Foundation. See the file COPYING at the root
 *  directory of the distribution for more details.
 *
 *  As a special exception, all sourcecode of the demo examples can be
 *  used for any purpose for licensees of the Coin Professional
 *  Edition License, without the restrictions of the GNU GPL. See our
 *  web pages for information about how to acquire a Professional Edition
 *  License.
 *
 *  Systems in Motion, Prof Brochs gate 6, 7030 Trondheim, NORWAY
 *  http://www.sim.no support@sim.no Voice: +47 22114160 Fax: +47 22207097
 *
\**************************************************************************/
/* ********************************************************************** *
 * coinhistory
 *
 * Demo application for showcasing Coin.
 *
 * Written by Thomas Hammer <thammer@coin3d.org>.
 * Some code borrowed from earlier Coin competition entries.
 *
 * ********************************************************************** */

// FIXME: causes a crash when running on top of SGI Inventor with this
// backtrace:
//
//  #0  0x4047740e in SoOutlineFontCache::getFont ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #1  0x4047622c in SoText3::setupFontCache ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #2  0x40475845 in SoText3::computeBBox ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #3  0x404676df in SoShape::getBoundingBox ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #4  0x40413265 in SoNode::getBoundingBoxS ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #5  0x4039cbaf in SoGetBoundingBoxAction::beginTraversal ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #6  0x40399070 in SoAction::apply ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #7  0x8049964 in timerSensorCallback (data=0x0) at coinhistory.cpp:818
//  #8  0x4048d961 in SoSensor::trigger ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #9  0x4048e8e2 in SoTimerSensor::trigger ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #10 0x4048dee5 in SoSensorManager::processTimerQueue ()
//     from /usr/local/sgi-inventor/usr/lib/libInventor.so
//  #11 0x40078cf1 in SoXtEventHandler::xtTimerCallback ()
//     from /usr/local/sgi-inventor/usr/lib/libInventorXt.so
//  #12 0x4078a33a in _XtRemoveAllInputs () from /usr/X11R6/lib/libXt.so.6
//  #13 0x4078a5a9 in XtAppNextEvent () from /usr/X11R6/lib/libXt.so.6
//  #14 0x400789d0 in SoXt::mainLoop ()
//
// Looks like a bug in SGI Inventor that is hard to make a work-around
// for.  20010919 mortene.

#include <math.h>
#include <stdlib.h>
#include <time.h>

#if HAVE_CONFIG_H
#include <config.h>
#endif // HAVE_CONFIG_H

#include <Inventor/@Gui@/So@Gui@.h>
#include <Inventor/@Gui@/viewers/So@Gui@ExaminerViewer.h>

#include <Inventor/SbLinear.h>
#include <Inventor/nodes/SoScale.h>
#include <Inventor/nodes/SoBaseColor.h>
#include <Inventor/nodes/SoCone.h>
#include <Inventor/nodes/SoCube.h>
#include <Inventor/nodes/SoCylinder.h>
#include <Inventor/nodes/SoShapeHints.h>
#include <Inventor/nodes/SoSphere.h>
#include <Inventor/nodes/SoSeparator.h>
#include <Inventor/nodes/SoText2.h>
#include <Inventor/nodes/SoText3.h>
#include <Inventor/nodes/SoDirectionalLight.h>
#include <Inventor/nodes/SoPerspectiveCamera.h>
#include <Inventor/nodes/SoTransform.h>
#include <Inventor/nodes/SoRotation.h> 
#include <Inventor/nodes/SoFont.h>
#include <Inventor/sensors/SoTimerSensor.h>

#include <Inventor/fields/SoMFString.h>
#include <Inventor/sensors/SoFieldSensor.h>
#include <Inventor/errors/SoDebugError.h>
#include <Inventor/nodes/SoMaterial.h>
#include <Inventor/nodes/SoShape.h>
#include <Inventor/nodes/SoTexture2.h>
#include <Inventor/nodes/SoTextureCoordinateEnvironment.h>
#include <Inventor/nodes/SoTranslation.h>
#include <Inventor/nodes/SoOrthographicCamera.h>

#include <Inventor/elements/SoCoordinateElement.h>
#include <Inventor/elements/SoModelMatrixElement.h>

#include <Inventor/actions/SoGLRenderAction.h>
#include <Inventor/actions/SoGetBoundingBoxAction.h>

// The History of Coin


char text2[] = "\
The History of Coin                  \n\
The humble beginning of Coin goes all the way back to late 1995 when the software developers \
at Systems in Motion created a 3D graphics rendering library inspired by, and designed to \
support, the VRML 1.0 file format. This library was used in amongst others SIM's VRMLview \
and Rational Reducer. \n\
\n\
.....................................\n\
                  \n\
After years of extensions, optimizations, and what-have-you, SIM's \
rendering library began to reach its limitations and needed a serious rework with a better \
fundamental design. We needed flexibility, functionality and extensibility to be able to support \
the requirements of future versions of Rational Reducer, as well as efficient development of \
custom solutions for our partners. We needed a high-level, retained mode rendering library with \
support for multiple platforms and multiple file formats. \n\
\n\
.....................................\n\
                  \n\
Parts of the API was already quite like \
the Open Inventor API on the surface, and since the fundamental design of the Open Inventor API \
is so excellent, we chose to make our new library, then named Coin, API compatible with Open \
Inventor. \n\
                  \n\
The API decision was followed by a long period of \"inventorizing\" our rendering \
library. \
\n\
.....................................\n\
                  \n\
With an alternative to SGI's and TGS' Open Inventor libraries on our hands, we thought; \
Why not make this great tool available to the rest of the community? The launch of Coin under \
the LGPL, and later under a commercial license, is the direct answer to that question. \n\
\n\
.....................................\n\
                  \n\
Our dream is to combine efficient coding \
and efficient performance into a library \
that will be a must for anyone writing \
software for 3d graphics.        \n\
\n\
.....................................\n\
                    \n";

int textpos;
int textlen;
float deltax;
int line;
int spos;
int currpart;
SbTime lastlettertime; 
#define XPOS -9.5f

#define LINE_BREAK 40
#define NUM_PARTICLES 160
#define NUM_LINES 3

#define FALLDELAY 3.0f
#define TEXTDELAY 0.04f

static int envq_raw[] = {
  857153075,857022515,672275240,588191011,588191011,537729056,520886303,
  504174878,520886303,537663520,604838436,554571809,437063962,521016351,
  655496999,756423469,689249065,622008613,689183017,672275240,588191523,
  638720806,655432231,655431975,571348770,571414306,554637089,588257571,
  722805035,588388643,554767905,571676450,571808290,723591467,874915380,
  942220856,992684091,1076767808,1043016254,992356667,925115959,790504495,
  723065899,622073893,554964257,537924384,537989920,537924640,537925152,
  537924896,588191011,638588710,655366439,638523174,588060451,554637345,
  453907483,470881820,487330333,504238622,437063706,537793312,638588454,
  756161069,672273704,655431719,554636577,521015839,504238878,470553628,
  487265053,487331101,487200029,537663008,554636833,588257315,537924896,
  554768161,655563303,756489261,756423981,722672683,722803755,672209192,
  588257059,621877797,588454435,621943077,588192291,554637089,521082655,
  554702881,622009125,554833697,588584995,622205477,622337061,824517169,
  908535350,975775546,1009526844,1110584898,1043082046,975645242,942156344,
  857876531,689512489,588454435,537924640,521147167,521081887,537859360,
  537924640,537924896,588257059,638588966,621746213,604903204,571545378,
  470750236,403707160,403509528,722803499,924655927,521345311,436998426,
  437063194,604836644,537727776,504238622,504172830,470618396,436998426,
  403443992,453841435,453775899,487330589,554636577,537728288,504239134,
  605231140,554702369,655562279,773200942,789978415,756423981,705961002,
  621877285,554899489,571610658,554833953,571676962,571611682,538122272,
  537991456,554768417,588388387,605297700,706485802,790568751,689905705,
  858071603,959063097,992749371,1043343934,1177760326,1009396796,958803513,
  1009399100,959001145,723199019,554768673,521148191,504239134,537859104,
  537990688,487526941,537793824,588125731,588125987,604968740,537925408,
  470815516,403837976,369758230,638587686,992224059,605559332,639245350,
  487658525,420220697,470552348,470487324,470618396,470683932,453775387,
  420155161,403247128,420287001,436998682,470618396,504238622,487330077,
  521147167,437063706,537925152,638785574,773135662,756423981,722738219,
  588388387,554834209,554833697,521213471,554833697,605362468,622205733,
  571742242,571742754,538056480,571611426,655826215,706485546,790633519,
  874650932,992683067,1009526844,1060317759,1144402756,1144403012,975581498,
  1228162889,1278757964,1093615169,689775145,537991200,504173854,504239134,
  521016351,487461405,504173342,520950815,571348514,588191011,537925152,
  454038043,420548889,420417817,520753695,891298869,706156842,437260826,
  605625380,521410079,420352025,420154905,453840923,470618140,470552860,
  470618140,420155161,386600983,420221721,403444248,470618396,470618396,
  487395613,487527197,436867354,554833185,621942565,672406056,655563047,
  554767649,521148447,521213727,521081887,487592733,537924640,571676450,
  655825191,655956263,588716323,555030561,638917414,739909420,925443639,
  993011259,1228220745,1245261642,1110583874,1178416454,1077424448,1161182533,
  1464357207,1716544102,1295337037,891629109,571677730,504239646,504239134,
  487396125,470422044,487395869,487461149,537793056,554505249,521081887,
  470749468,420548889,437063706,587928099,908076854,622074405,285477393,
  470946844,521344543,487724317,454103835,403509784,470683932,470684188,
  504369694,453775643,420090137,420221465,436998682,386535447,504304414,
  487395869,487461405,487592989,521081375,487461405,554833441,588453923,
  487659037,470684700,504370718,470684956,622205477,571742242,588519459,
  605428260,571741730,672733736,655890983,622270757,689577257,773857582,
  1228683337,1279209804,1245457994,1127755075,993406523,1212629320,1279806540,
  1717331046,2104389245,1750420840,1043214142,706356010,554703393,487396893,
  537925152,419958809,436801562,453644315,487461405,504173086,504173086,
  420417561,437326106,436932378,688854569,1261056843,621613861,285478161,
  370153750,454103835,420352281,470881308,487724573,470815772,555095585,
  571742242,520950559,453447963,436800794,436932122,453840923,436932378,
  386666775,538188064,504304414,605230628,521016351,470618652,537990688,
  521147423,470751004,453907995,521148191,571677218,454039067,538254112,
  420353049,555097121,538450976,706551850,655956519,740040236,757014829,
  925312823,1632586593,2002672247,1751862888,1279868748,1397577299,1717925990,
  -1987739511,1987078774,2070833019,1481130072,823797809,605101860,604970532,
  470488092,520886559,403051032,403247384,420155929,420154905,487526941,
  403443224,470880796,487395613,654971431,1445674070,504107038,537990176,
  369560342,470618396,403311896,504567326,470947100,454038299,487526941,
  537595936,520753695,503910942,453710107,487330333,554833441,487461405,
  470618396,386667031,504436510,504304414,638916646,504173342,504239134,
  504238878,504173342,420288025,487528477,571611426,622074405,504436510,
  538122528,588651555,453907483,571874338,740106796,723196971,807412016,
  841229874,1093677633,1750752104,1936092787,1884647024,2002874743,1969973621,
  1566264157,-1853976431,-1551000157,2002872951,1177302342,907817014,621813541,
  554507041,588389411,537664032,453580059,453776155,437064218,504369694,
  420220697,437194522,487460893,587797027,1244148298,671618088,436932634,
  504304158,436932378,420089113,369756950,470881308,470881308,470749724,
  470683932,655037479,503976222,436932890,420220953,470683932,537924640,
  453709851,436932634,420353049,487593501,521147423,638916646,504173342,
  537859360,554702369,521016351,470619420,521082399,605231396,706091818,
  622205477,622205477,487461405,622205733,823926321,756818221,790503983,
  891561269,958999865,1127363651,1396720211,1396719699,-2108070782,1328887631,
  959065657,1581932638,2001961079,-1871866480,1682137188,1059075135,705832234,
  621748005,588193059,521017375,537664032,470423068,504305438,470750492,
  470487324,453644315,420023833,504107806,991831355,705763370,487461405,
  487329565,352717333,386403351,453775131,521147935,453972507,504369950,
  571413794,688658217,537596960,403181592,386535447,420155417,453775387,
  487527197,521147423,521213215,437196058,521279519,588519459,554701601,
  554702369,537859360,521016351,537859360,537925408,521016351,621876773,
  807018032,605230628,706288682,689445673,739909164,941630008,941761848,
  891430197,992487739,1059991359,1127035459,1295333965,1143615300,1092826177,
  773923630,672802344,1024805437,1614442848,1446273622,722415147,1211122504,
  655303207,604904996,520821023,504174366,554507041,504109086,504305438,
  403378456,504108062,470422300,537663008,621943589,637668902,403377432,
  404297240,403114520,554768161,470618140,504304670,504303902,605034020,
  722672683,839982642,772676654,605099044,554701601,521081375,521212703,
  521278751,487592733,639113510,554964257,454039067,504568094,437196058,
  420353049,470751260,504305438,521016351,554570785,554570785,588256803,
  621942821,655628839,723132459,588256803,773332014,941564984,1210656840,
  1126772291,992290875,1042951230,1076637760,908470838,857351987,722740523,
  705244714,538058272,790768431,1175733830,1495494233,1327195983,553660449,
  772613934,638460198,588061987,638853158,453645339,571675682,538121504,
  588782371,420484121,537136160,604508708,874128436,571086370,420023577,
  470618396,436932378,420155161,470749468,470749724,504369694,621811237,
  739318828,806492976,772872494,672143400,655627815,739645484,739711020,
  655627815,571544354,588387619,622073637,622073637,554965537,487593501,
  470750492,487593501,420222233,453776411,487330333,520884767,621942821,
  554570785,554570785,655628839,571414562,706026794,621614117,823729713,
  1193946439,1076243008,1009002556,1009200188,941894200,790373423,739582252,
  806758192,991505467,1042560318,755773741,1410885460,1477470296,1410689620,
  1394827603,570497826,571022626,621617189,571350050,571481122,571676450,
  504304414,470618396,487527453,621482533,924722743,537465376,436604954,
  521147423,504304414,470618140,554898977,521278751,521212959,621942309,
  655496999,672339496,621942053,605164836,605164836,537924640,605164580,
  722670891,857348915,874390580,604771108,638457126,722672171,521147423,
  521147423,622205477,537990432,470751260,521148447,571545378,621942821,
  554570785,605099812,638785830,605099812,554506017,621746213,873996852,
  891035957,991897403,924787767,924919351,925116983,790307631,773398830,
  773137198,823469361,840309298,772088622,1293112909,1410493780,1427069269,
  1023428925,1361075281,553655841,469833500,688923689,638460198,588193059,
  453645339,571414562,554373665,705763114,891233077,588190755,521016351,
  436867354,403246360,487461405,487395869,537990432,521212959,588387875,
  605165092,588322339,571545122,537990432,537990176,537990432,504370206,
  554767649,571545634,588520227,874127668,975251258,789912623,705697578,
  554701601,588387619,588387619,622073637,470751260,521148447,588388387,
  655628839,621942821,655628839,672471848,621942821,672145192,638327334,
  873931572,840376370,857350963,840573490,823993137,790439727,756555565,
  756292909,823468593,806428720,672669480,872887092,1713729126,1192447815,
  1125988163,906966838,990987579,839594802,638132774,638132774,655237671,
  537402144,504240670,554572065,840441650,1092691265,554701601,537990432,
  420155417,420353049,436932378,487461405,453775387,537989920,554701857,
  571544610,588388131,537990432,487658525,487658525,487527197,504369694,
  470618396,453840667,487328797,571412002,772806702,890444853,1463107415,
  789124143,455023131,386471191,638460198,504500766,537727776,537727776,
  723000875,605099812,537925408,571414562,705895466,688658729,688789545,
  655103527,705632554,823664945,840507954,790109743,739713068,773333038,
  739647276,722672683,739385132,739188524,570956066,823601201,806758192,
  672014120,739188524,621221925,553718817,907291190,889267509,654319911,
  655238439,705764394,556080673,771755822,2100843645,470356508,537859360,
  521016351,436801306,487330333,537990432,470552604,554767905,521146911,
  588387363,622007589,571741474,538121248,487592477,487526685,487526941,
  487526941,487461917,504173854,537859616,470619164,437391386,723065899,
  991371579,1748387688,655039271,621811749,521278495,537794336,706157866,
  621942821,621942821,554570785,504173342,672340776,874193716,789650735,
  840310834,789781807,773004590,873931060,823402545,773070126,739450412,
  756227629,722803755,705829674,773005358,789717551,688856361,705699370,
  773071406,705699370,722476331,789717551,789652015,806233136,823141937,
  655304487,554573857,655432231,1006637628,-1890227313,1041441854,655301415,
  537859360,521016351,436801306,487330333,453775387,537990432,386403351,
  453775387,521081887,689117225,588388131,521147167,504304414,487527197,
  487526941,487461661,638589478,537597728,470423324,453842971,572070178,
  672667944,856955955,1058284095,2017089144,755503149,723130411,436737050,
  706157866,638785830,571413794,672471848,638719782,672143144,756226605,
  941040184,873930804,840244786,806624816,857153587,823402289,756227629,
  756162349,806559536,722803499,756292397,873866036,890643509,840376626,
  671946536,773004590,789847599,823598641,806624816,789519663,772611374,
  655760423,588455715,688923177,1092102721,-1236107850,1040719934,554834465,
  537269280,537859360,521016351,436801306,487330333,554833441,521081631,
  571676450,487461661,537729312,907680822,655562535,487461661,487527453,
  571414562,588257315,621746469,857088563,756292909,705567530,722213675,
  856693299,958145081,756751917,605558820,1477517400,-2025235321,788994607,
  521411103,638785830,689314857,588256803,723000875,722802987,840507186,
  924459063,991503163,924261943,941104952,957816889,907484982,873734452,
  840048946,890511925,873799476,857218611,857218867,924328759,924197943,
  907879222,789978159,857350195,857350195,857284147,890904885,1008674876,
  941040952,890838325,722147627,1495547737,-1672581220,721753643,688987433,
  504437278,638853158,537859360,521016351,436801306,487330333,537990432,
  470618396,487461661,605296932,906695990,1058809663,571348514,571414306,
  739449644,941105720,1025058365,957948985,1125722179,1075258688,1007887164,
  1041310526,1125330499,1141973828,1260398923,739646764,455283995,1310337614,
  -1386972755,671092264,773725742,588321827,1025977917,604574500,924000055,
  957686073,957686073,1075587136,923802935,1024794941,1210067784,1092166721,
  1041900862,991306299,924131383,1075783488,1210199368,1024794429,1109076034,
  1126050883,907418934,974857018,924525879,739318572,1175922246,974134842,
  991569979,789848367,825174833,1376334418,-1152545861,1225729353,957949753,
  840179762,756095789,705697066,655104295,571545378,538186784,605098020,
  369430294,537794336,487132701,688854057,1059269183,739449644,537859104,
  655497767,991436603,1260464459,1294019405,1226648649,1293691725,1310403406,
  1310338382,1293757517,1226059081,1411396436,1125852483,588059683,723198507,
  722409771,1276849484,-1974640246,823401009,773003822,756226605,840376626,
  940711224,1008083260,974397242,1109141314,1092166977,1159472965,1243556170,
  1361456977,1209673032,1142498116,1092363585,1109403202,1092034881,1226845001,
  1007951932,1058547007,974790970,974790970,856889907,1008543036,1192567623,
  1293954381,1075389504,1075586368,1191980359,-1587709279,1343695440,706026794,
  772742702,756162349,688987433,605100580,403576088,487593501,554701601,
  689379113,672996904,402917656,1126378051,1294085197,772806190,806887216,
  672537640,689117481,991371835,1243490378,1327443023,1310600014,1411197780,
  1427909717,1495084377,1579298910,1444358742,1276586572,772610862,638786598,
  671291176,470750492,605558820,1107957826,1933791859,805638960,957752121,
  587731491,974265402,1109009474,1024794429,1176381510,1226845001,1277242444,
  1479226456,1394945363,1495741529,1344154960,1209804360,1125851971,1125457731,
  1327705423,1210001992,1058480959,1041901118,957554233,1176249670,1294084941,
  1579104606,2134922879,1579365726,1596208223,-2026873209,1259348043,1109794626,
  807346736,1008215100,823270705,688987433,571546402,589241635,671682856,
  1276716620,1142497092,974723898,1193288775,1681144932,1343693904,823269937,
  672011560,537990432,706026026,991371835,1243293770,1344023120,1394289491,
  1646671714,1747401576,1831747181,1915568754,1814442860,1562851421,671882280,
  537794336,738988844,739645996,605362468,705895466,1511402842,2051036794,
  923671863,705632554,1058348607,1243621706,1108877634,1260464715,1395077459,
  1327705423,1293821773,1462185815,1663646051,1630222689,1260070731,1411920468,
  1361193553,1445474646,1277176396,1311060046,1243951946,1125852995,1361193809,
  1529228379,-1285780813,-4265729,-1808047212,-2010165112,1227237193,1310599758,
  1915569266,-2043197050,1849310830,1142431044,940973368,823730225,1008539964,
  -1874636144,-883132981,-1302895438,-1824699501,-1992406135,1579560286,974329658,
  924393527,671945768,605166116,588453923,823533873,1159473477,1411461204,
  1545810524,1663448675,1764506217,1865564271,1949582708,1848461422,1613118816,
  923671863,403117592,773531182,503976990,790110511,789978671,740302892,
  1327969103,2135448191,570427938,924456759,1429353301,1074993984,1428303701,
  1310797390,1512847450,1512649818,1462054743,1730886759,1832468845,1293821773,
  1680425572,1479029848,1479029848,1512715866,1260070731,1360276305,1511994458,
  1326917711,1596733791,-1537777500,-544956449,-1067088448,2033401721,1545938012,
  -2110437502,-1084392001,-1320262223,-1605016160,1915041650,1208949832,807083056,
  1177230662,-1000246844,-933203512,-747864621,-747537453,-1286316109,-1757656681,
  -1858451055,-1656468835,1746806632,974199354,655300903,789846831,1109074498,
  1344286032,1545876572,1360931409,1327245391,1360800081,1428106325,1629302625,
  1797928299,1596600415,974659386,537663008,722804267,688920617,688854569,
  722934059,755438125,1310666318,1429158485,924393015,1025188413,1361654609,
  1243425354,1428500821,1563178845,1344153680,1697659237,2033994617,1781873514,
  1394681939,1815168620,1647196770,1765097833,1613510752,1360865617,1427910485,
  1596274015,1798324331,1697134437,-2060234107,-1183808071,1814706284,2067089531,
  2034386553,1831352429,-1672977508,-1370002002,-1319474767,-1454480727,-2009248376,
  1428828245,1077226560,-1639691874,-680300841,-612465957,-646348071,-983076411,
  -1286052941,-1454350935,-1471456344,-1605805920,-1807132780,2016822392,1680751204,
  1546400348,1462119767,1411590996,1697132645,1461922903,1209804360,1058612287,
  789651759,857022003,1025189181,823665457,705895466,789978671,823598641,
  857087027,1008346172,1109601090,873602100,1176185158,1428896085,1058349887,
  1243556426,1479292504,1596666975,1916618354,1714304102,-2092281469,-2042081402,
  1933393267,1950433908,2000308599,1916224626,2084654716,1781480554,1680422500,
  1647393890,1613313120,-2126557823,-2042868346,-1554612829,2067615099,1865956463,
  -1891083633,-1806738284,2050376058,2083996284,-1874373232,-1774172266,-1690482277,
  -1706929766,1865365103,1025909565,-1420602965,-948543545,-914787127,-494301214,
  -679640361,-915442487,-1151376453,-1420927317,-1471522392,-1320395343,-1320526927,
  -1623043937,-1975892086,2134065279,1915566450,-2059777659,1815034220,1277242188,
  890642741,605232676,655628839,907483702,856955955,756292653,806755632,
  890773045,1042294078,957226041,739317804,1126969411,1108550210,1646606690,
  -1772393578,1562717277,1815689580,1882734448,-2008066168,-2109190014,-1503040090,
  -1351584593,-2058466683,2118731390,-2109518206,-1924376179,-1907533170,2101102973,
  -2109649278,1731936359,1663841379,2100773757,-1672980068,-2143137152,2016560504,
  -1823975277,-1604822368,-1504748378,-1823848045,-1755885929,-1672194404,-1637985634,
  -1419813717,-1723117927,-2092349565,-1554688605,-882217781,-1924119667,-813397809,
  -443509531,-662600232,-831294258,-949459001,-1083545153,-1117559363,-1118083907,
  -1151901253,-1269866316,-1387503699,-1538630748,-1740483432,-1538631772,-1992536951,
  1478964056,806821424,705763626,688986921,672407080,706225194,722540075,
  789583919,873470260,991042875,1125655363,1344417360,1192370759,1478504792,
  1546923868,2000964215,-1100965954,1814445420,-1805362284,-1840358254,-1603901024,
  -1032090686,-1048538943,-1570477406,-1486198361,-1553631837,-1738245736,-1637648994,
  -1739301736,-1470341976,1865960559,-2042210938,-1553897821,2135638911,-1285590861,
  -1488102489,-1470933080,-1755885929,-1100786242,-1083613505,-1251582283,-1503897690,
  -1604625248,-1284017997,-1705160038,-1554951517,-680233513,1983986038,1698773605,
  -595093540,-510355487,-796950320,-797411632,-882022197,-1100585794,-932286776,
  -881954101,-915705655,-1067422528,-1168545606,-1252760651,-1336975440,-1269472588,
  -1538566236,2050441850,1058940223,705960234,688986409,705632810,688527401,
  789781039,874127156,1042425406,1008673852,1142563652,1310862414,1714634854,
  1731280999,1646868066,1562979677,-1587842143,-1015442749,-1787930219,-1267302988,
  -1149336645,-560682018,-527257632,-830105138,-897477430,-846747187,-779180079,
  -1132950084,-1099331138,-1503696474,-1606388320,-629497638,-1993325175,-1773315946,
  -1739238248,-1032227902,-1217633865,-1318297167,-1284351565,-1098880578,-1216451913,
  -1216188233,-628061222,-1183554119,-1217504073,-999462716,-1740289640,2034647161,
  1832728941,-561935138,-527658528,-662600232,-797608240,-882086965,-948932921,
  -982815803,-932483128,-831556402,-898992694,-949521977,-1033801790,-1151702853,
  -1067554368,-1252367435,-1773579370,1512780634,840376114,705895210,705763882,
  1176382534,1260661835,1159603781,958013241,1009001532,1311190606,1294215757,
  1428565845,1664170851,1949321076,1933263475,-2091823997,-1301578318,-425807386,
  -830366514,-728128556,-458903068,-223623950,-341656597,-526927904,-425932058,
  -493569822,-510282527,-846946611,-1082617665,-325864212,-1740221544,-1470014040,
  -1638112866,-1284410445,-1334812752,-947492665,-931041336,-762354222,-576949539,
  -728470572,-610437669,-830046770,-594511652,-797220912,-1151183429,-1739238248,
  -1991291511,2101165437,-713524011,-494827038,-494827038,-747538221,-865570868,
  -1100585282,-966038586,-848267827,-831490610,-865372980,-915967287,-999985212,
  -1016959549,-1016828477,-1134466884,-1470669144,2084455804,1378430034,991699771,
  873996084,1042032446,1512584538,1680423268,1428499797,1294347341,1092362049,
  1176577350,1445474134,1563243869,1933197683,-1958520693,-1637259618,-1149468485,
  -846947891,-223951630,-307048211,-255863056,-104539911,-121842440,-206188045,
  -206250253,-206577421,-207038989,-510478623,-494098206,-1133608004,-1486592089,
  -1520343387,-1134193732,-562058786,-1251514443,-829527346,-290944018,-424505370,
  -87645190,-87843078,-256404752,-223040270,-4743425,-729652780,-1133879364,
  -1688778341,-1924775283,2100508797,-1756935017,-613319973,-680560169,-916296503,
  -1151966533,-1302767694,-1218486345,-1168153926,-932679992,-781027119,-882019381,
  -882150965,-949522745,-1016829757,-1084135489,-1319410767,-1806937196,1832205165,
  1361653841,1092494913,1025189437,1445213014,1865499503,1748057704,1461923159,
  1462514007,1546531420,1428171093,1545809244,-2126428031,-1873521008,-1250722635,
  -999125308,-695034922,-509104415,-104275463,-86248966,-85790214,-35983619,
  -154080778,-120525832,-70129413,-70985221,-493306654,-729699884,-746478893,
  -1486785625,-1402506068,-780494639,-207638797,-1251382859,-1048155199,-794529072,
  -103499271,-85597702,-320671508,-118888200,-2312961,-206139661,-510496031,
  -1184014663,-1453829463,-2076428156,1933196147,1546663260,1949643636,2100770685,
  -1723511911,-1454614871,-1370466898,-1504685146,-1420666709,-949587769,-764513070,
  -865308212,-932614456,-983077947,-1235721546,-1336385872,-1386914131,-1655679331,
  2134722431,1681012836,1294282061,1142827076,1411855444,1949779828,1915961970,
  1781414762,1512451930,1613837664,1966950005,2135052159,-1873913968,-1721933927,
  -1014658621,-628186150,-240993807,-441995035,-154805258,-51841028,-51185668,
  -17564674,-17760770,-51643652,-119410184,-52628996,-71507973,-22032642,
  -864053812,-998273852,-981562939,-1167688006,-1251643467,-1200591688,-997757244,
  -575831843,-321800212,-790273,-202244109,-723713,-2247169,-290354706,
  -594711076,-1352444753,-1706275686,2134654591,1478699352,1125918019,941564728,
  991436603,1562849117,-2110045054,-1807595116,-1958525557,-1555015261,-932810040,
  -815107121,-932811064,-1017090621,-1084462913,-2009184632,2084127612,2017018232,
  -2025632889,-2143271296,1815493740,1512911450,1243818314,1294216781,1815298668,
  2117880702,2100906621,1899118961,1630090081,1680225124,-2143335040,-1621465185,
  -1738776936,-1317636175,-762471726,-460147996,-340739861,-121186056,-85396486,
  -84214790,-117769736,-84148998,-100860423,-101187847,-135988745,-20125698,
  -324880916,-880178229,-829846066,-1082884673,-1116703043,-1251316043,-1166840390,
  -1065129280,-340357141,-203241485,-198145,-151519242,-1537,-2181377,
  -222982670,-561025058,-1369287762,-1942142068,-2109847934,1360864849,974463802,
  840440626,907680822,1176643654,1630089825,1832007789,2017345656,-1571988830,
  -1017090621,-949785657,-1034065982,-1319739215,-1656269155,1563045725,1663906915,
  1428565845,1344548176,1563178077,1546531420,1411985492,1310994254,1277439052,
  1563244893,1983531638,-2126622591,2050508922,1983465590,-2109648766,-1890952817,
  -1924770419,-1604163936,-1216316233,-846228531,-627726118,-558912034,-19600898,
  -68815365,-50659588,-16777218,-67438085,-1025,-134808585,-85263878,
  -36574979,-205927693,-997294652,-1116112963,-1335793744,-1284741453,-1402510164,
  -1116049219,-1014665533,-357527574,-102381831,-397569,-459777,-793089,
  -86725382,-189296652,-561025058,-1318758735,-1689892197,-1840952430,1764505449,
  1125458243,1344548688,1041834302,941169976,1042031166,1244015178,1748121704,
  -1924903283,-1487905881,-1336713296,-1538304092,2134655615,1613574496,1361258833,
  1495674457,1344482128,1024991549,890773557,1042097214,1193354823,1327770703,
  1378234194,1462318423,1663974243,1882472816,1949713524,2101168253,-2109912446,
  -1689100133,-1487180121,-947614521,-644178215,-156320522,-256456976,-88814342,
  -2822401,-135398409,-590849,-17302530,-459777,-525313,-51119108,
  -16779266,-203751437,-20582658,-6043905,-90326790,-595226660,-897944118,
  -1217830729,-897814326,-948213305,-72443141,-1722881,-2315009,-1920257,
  -2315009,-3428097,-89091590,-712546091,-1452715607,-1724102759,-1673509732,
  -2042937722,1075060288,840310322,756161069,739449388,739514924,907812918,
  1277307468,1546335324,1899380337,2101232765,1831942509,1277371980,1075782720,
  1445079638,1545940572,1428433749,1142694980,940973880,890641973,957882425,
  1042031934,1176380998,1277176140,1461924183,1714437222,1949712500,2118011006,
  -2076226428,-1756406377,-1638767202,-1233945674,-997881404,-627924774,-644505383,
  -291393298,-122042120,-1575169,-84148998,-100992007,-100992007,-84148998,
  -101318663,-17302018,-19269122,-55653124,-292049426,-881228341,-1285069645,
  -1200463432,-1116183363,-1149870149,-728730412,-358184982,-660376104,-424573978,
  -407730969,-508789023,-829265970,-274300433,-628921638,-1083876417,-1538764892,
  -1774107242,1949448052,1159340869,1025319229,890641205,806689840,722606123,
  722803499,756358189,890838581,1092560193,1210328904,1025188157,857020979,
  1092100929,1512255066,1646735458,1546072156,1327573327,1126048835,957947705,
  941104696,991633723,1125983299,1226778953,1478964568,1916355698,2050770554,
  -2092609917,-1958325365,-1722786151,-1436651094,-1217102665,-930509368,-644767783,
  -409230105,-274553361,-3814913,-53024004,-101122311,-101122311,-101122311,
  -101122311,-84935430,-52036868,-3416321,-123423240,-392648984,-847214899,
  -1183553095,-1216913481,-1183293511,-1115987779,-1048485695,-1031643454,-694850090,
  -576949027,-829594162,-543263009,-930455608,-1065789248,-528058400,-832412978,
  -1488105561,-2009251448,1647129442,1058742335,1126113603,974658618,857021235,
  756160301,638720550,554702369,621942309,689380137,806623792,705632298,
  823072817,1142300996,1277175884,1630024289,1630090337,1462186071,1277241676,
  1075586112,991633723,1041965630,1176512070,1294085453,1445211990,1832075629,
  2033992825,-2059055227,-1924639603,-1790158187,-1605081184,-1452904791,-1014724413,
  -678453801,-577593379,-543450657,-289949970,-2690049,-102567175,-18352130,
  -1443329,-68881157,-1512449,-2886401,-458970140,-375674135,-561537570,
  -898071350,-1402970708,-1166777414,-1217568841,-1116511555,-1082761025,-914331703,
  -1082499137,-914069047,-1149871173,-1065656128,-1234347082,-1554165341,-1386260307,
  -831756850,-1555478109,1881944432,1310927950,957881401,873930036,756160813,
  688986409,588125987,537859872,504305182,521016607,554636833,604967972,
  571676194,672602152,806755120,857152051,1159471173,1378036050,1378167378,
  1226844233,1109206082,1058809407,1109206082,1193157447,1260529227,1428564821,
  1815559532,1882603888,1966622069,-1958258549,-1958455669,-1939842676,-1538034780,
  -863596340,-627338278,-291326482,-341985045,-21770242,-206059277,-223025422,
  -19600898,-136848393,-3414273,-2173697,-341063957,-4593153,-814050865,
  -308305171,-1319602511,-1435278422,-1352839249,-1469686616,-1554165341,-1099865410,
  -1049731903,-1134077252,-1134011204,-1234871626,-1167433542,-1386390611,-1588440671,
  -1706275686,-1908260210,-732733228,-1555672669,1428106069,1024663869,773266222,
  705959978,571281954,537794080,453974043,470553628,571479842,520950559,
  571806754,521541919,471078940,605230884,1008213820,1092166721,1159472453,
  1260202059,1226581577,1125852227,1058612287,1058612287,1075520064,1159866181,
  1361521745,1647458146,1899512177,1916027506,2117749374,-1975298678,-1503828314,
  -1487377753,-1233552714,-678059561,-290530834,-3477505,-576996131,-105786631,
  -38147843,-3546881,-508841759,-156648458,-207702541,-644831783,-711939627,
  -4792065,-1200587080,-1166183750,-1285528397,-1185256263,-1941420916,-1739502696,
  -1504096090,-1302243662,-1201514568,-1184605767,-1302308942,-1420144213,-1840691054,
  -1806873452,-1924642419,2016753528,-1942209908,-1067488832,-2127807359,924064311,
  874324276,722802987,537661728,622074405,436933402,453776155,605231396,
  621877029,571413282,604968996,705763370,873798964,1428435029,1310796878,
  1243621450,1142761284,1109140546,1058677823,974660154,924197175,991437627,
  1058743871,1210198344,1428696917,1714371174,2050706042,-2109845630,-1992141687,
  -1791340139,-1520409435,-1284408653,-712595499,-4860161,-594499364,-39273219,
  -5716225,-409485849,-190397964,-460217884,-5982977,-326718228,-274682897,
  -913863479,-797137968,-6431233,-1520607323,-1285986893,-1924706675,-2009054584,
  -1806938476,-1924905331,-1756607081,-1622324577,-1740093800,-1790490731,-1824045165,
  2000371063,1865758831,1899642481,1596534367,1345333328,1780361066,-1858581871,
  1109402434,756423213,689116969,571347746,571545378,538056736,537859616,
  588322083,588059171,739252268,974528058,1260201803,1411460948,1899117681,
  1714174054,1562849885,1327574863,1243490634,1142695236,1058612031,974725690,
  974725690,1075520832,1193421127,1445540182,1849049710,2067746171,1983071094,
  -2042670714,-1857397615,-1705352806,-915631671,-444028187,-998080572,-678652713,
  -460217372,-308892435,-107367431,-73680645,-241913615,-510876703,-1098675778,
  -796750128,-612069669,-1335006032,-1000569404,-612522789,2067481979,-2025567097,
  -2043001978,2100510077,1999649655,2083930748,1983069046,1865234031,1882208880,
  1815034476,1378035282,1277109068,1277175116,1311058766,907813174,738988844,
  974331450,1209935688,756423213,689116969,571347746,605231396,638851366,
  571414050,621810725,722540587,1193027399,1630221409,1882275184,1966358645,
  2134132095,1999913847,1865432687,1663776611,1495674969,1310927950,1126180931,
  1025319997,958079545,991568443,1159407429,1411920212,1663580259,1713977446,
  -2126623871,-1874110832,-1889378673,-1203008328,-427839002,-1385207891,-1302104654,
  -931427640,-981694523,-728984108,-459562524,-846951731,-897480758,-846951731,
  -1099404098,-1234409546,-1167429190,-1370002770,-1923394419,-1740481384,-1522373979,
  1983135862,1664301923,1849246318,1764505449,1814508652,1461726039,1596470111,
  1579627102,1562784093,1058282047,1193157703,890181429,1075520320,907812406,
  722671147,807018032,672405800,873471028,789715759,453512731,487724317,
  487722781,621941797,773134638,1042032190,1663842915,1999979127,2117617278,
  -2127017855,2050246266,2016691576,1898987889,1730821223,1495675993,1277242188,
  1075651648,924459063,907550518,1041966142,1209936456,1361325137,1512190042,
  1714108774,-2092806269,-1941482356,-1707190118,-309350675,-1924837747,-1992143479,
  -1318947663,-1520932955,-1318554703,-1267960396,-1217497161,-1352241233,-1385927251,
  -1369084242,-1604692576,-1891088497,-1571463518,-1639030882,-2109320574,1629368929,
  -2060234107,-1319930447,1461792087,1394354003,1612984416,1814902892,1461922903,
  1428236885,1377707858,1428236885,1210197832,1176643398,873601332,974790970,
  722539307,790043183,705959978,588190755,722343723,655168551,739777836,
  554964257,504238622,739317292,1075586368,1495741785,1983267958,2100840317,
  2117618046,2083997820,1999783543,1949517172,1781480810,1529492827,1260596043,
  1042097214,857152563,840244274,890641717,957816889,1058677055,1193289031,
  1378168146,1866155119,1781218154,2016363640,-1051427135,2084058748,1866215791,
  -1840947054,-1958982005,-1706206054,-1486984793,-1537448540,-1638571106,-1621728097,
  -1638571106,-1756472169,-1975235702,-2042607738,-1924639859,-2008854392,-2110040446,
  1680620132,1461464151,-2060955515,-1688506725,1343563088,1562784093,1664170083,
  1344350800,1310664782,1344350800,1293821773,991698747,857086515,756226093,
  823664177,756225325,739514156,621744933,706091818,571413794,655562791,
  756489773,739580972,704976170,1361523537,1613576800,1899250545,-2126754943,
  -2093265789,2067023995,1966228597,2134264703,1848787822,1495872857,1092626241,
  840441650,773135150,823401265,857021747,890641973,873733172,991436347,
  1159603525,1311189070,1344284752,1915897202,-1756732009,1377118546,1580216414,
  1949452148,1915765106,-2026354041,-1925165171,-1823844973,-1907994738,-1891281265,
  -1891281265,-1722851175,-1790223211,2033468537,2067285627,1764374633,1764571497,
  1898528369,1730687847,1428367445,1159406661,1797602667,1949583220,1209278536,
  1041570622,1226712137,1142497092,1243555146,1226712137,806886192,638522150,
  706091818,605099812,773068334,638456102,823861041,503975710,504632862,
  521278495,621614117,924197175,1949122164,-1975364214,-2025696121,-1908124274,
  -1824172909,-1958785141,2083735164,1999717495,2000175991,1428566101,1008477500,
  773201198,857152563,823729201,688724777,1394618707,1192961863,940974392,
  1092363329,1092297537,1143091524,1965179765,-1370919762,1445408854,1293494605,
  1613445984,1562719069,1798455147,1764769129,2067481979,-2076096124,1916158578,
  2135051647,-2059251579,-1975693430,-1858449263,1731345255,1361260369,1209871176,
  1394682707,1596272479,1848983406,1343891024,1360865617,1243555914,1326325839,
  2050378362,1041965374,923999287,1058743359,974528314,1024991293,722278699,
  789781807,789978159,672208168,773460782,470617116,639180582,487198749,
  420419865,772742702,906697014,1075716928,1764573545,-1959111797,-1908846450,
  -2026288505,-1992405367,2050311546,1848523630,1983136118,1293822797,840178994,
  655366439,638457894,840439858,722606891,722411051,1158947909,924131127,
  907287862,1058414655,1176118342,1763194985,-1739560296,1529033819,923998263,
  1361260369,1377971794,1428368725,1579823966,1478635864,1831877485,1966423925,
  1613182048,1882275696,1865235311,-2143860608,-2009444728,1361127761,1075257920,
  1058547007,1327573583,1344021840,1360996689,1462120791,1125458243,1024662589,
  1058677311,1159341381,2000112247,1075126336,805769776,940645432,873601332,
  789650735,789781807,756292141,722737195,722866731,554832673,622140453,
  621614117,823598641,1209870408,1545941084,1293952077,1512059994,1915437682,
  2032812665,1646472034,1630352993,1377839698,1360930897,1461791831,1125853763,
  789716527,689051945,655366439,722475051,756358701,688921641,856759603,
  891036213,940974136,1007557180,1444555606,-1505203546,1310468686,639047206,
  958276921,1260595787,1210000712,1479357272,1445539158,1327574351,1731345255,
  1798519403,1445277782,1545218908,1730492007,2050706298,1730754407,1210000712,
  940974136,907485750,1125983555,1243556426,1041571902,1193225031,991306811,
  1008214332,874521140,840441138,1629238113,-2041881210,1074469696,991108411,
  873863988,755964717,688723753,621548069,655365159,655495975,537727776,
  571282722,1075717440,1462251095,1646473570,1965964661,1545874268,1327311695,
  1192698695,1478700376,1966621557,2083667580,1966293109,1714306406,1361260881,
  1478700120,1176249926,873733428,688855081,672078120,688790057,655431719,
  403181336,739777836,789517871,1596602975,-1874370928,923997495,823531313,
  908010294,924066103,1193748807,1193683015,1294543181,1277568332,1193225031,
  1546466908,1512583002,1260399435,1763916137,2050575226,1579562078,1378102610,
  1109337410,840310834,756293421,907418934,991503163,839982130,873799732,
  857088819,890904885,923868215,1092035905,772740910,1662661731,-2109450366,
  974068282,705697066,806493744,772938798,722606123,722737195,689116969,
  554439713,671946536,1311058766,1546072156,1865104495,1982677622,1394288979,
  1024728893,907615542,1092493121,2050507130,-1858318703,-1975890806,2033336953,
  1680356196,1882276208,1646868578,1142761540,689117737,705763882,706091050,
  588254499,857087027,606413348,1712736358,-1371504978,874058804,638127910,
  974988090,907616054,924459063,1092823105,991765051,1092823105,1092823105,
  1042358846,1395602515,1243096650,1292903501,1832797293,1175986502,1142499140,
  1108945730,974331962,1008215100,772741678,773069614,756356397,840639538,
  603984164,1309613902,1125718851,1092296769,823269937,638458406,773986606,
  1646343010,-1504874842,637537318,723263531,554833441,521279519,555097121,
  638915366,655167271,1024662589,1411132756,1394224467,1427910485,1326852431,
  1394224467,806952240,773266222,621679141,806952240,1831943021,-2143401600,
  2067351419,1932936051,1461857623,1428171349,1159406917,722671915,621812517,
  537925408,689379881,587403555,1780364138,-1655607139,1158489925,622007077,
  840375858,874061876,705631786,991962939,1025517117,1025517117,958145081,
  974988090,1025318717,1109271362,1209673288,1596471903,1243752778,974265402,
  1024860989,1007887676,991372091,856825139,823467825,688986153,756423213,
  705895466,839851058,2017809016,1159668805,957750329,739186732,672078376,
  723064619,907418166,1596668767,-1688570981,671945768,570953506,621811749,
  453776411,487658269,638785830,806493744,957489721,1025189181,873602100,
  1025189181,974660154,588058915,773332014,672273960,705959978,671222824,
  1091838785,1327442767,1428302933,940907576,1008213820,907484470,621877285,
  521083423,571546658,621417509,1512718682,-1758638953,1124865859,589043747,
  504436510,722606635,823664689,756292653,857350707,789846831,890904885,
  789846831,924590903,1058610751,1226909769,1429157717,940645432,671945768,
  806558768,974595130,1008215612,772741678,823467825,722672171,706157866,
  621878053,705763626,739054892,991503163,840112946,772872750,840310834,
  789781807,672011560,690036777,689576745,1646146914,2051430010,839324978,
  654971687,605231396,336007188,453777179,453580059,419827993,487461405,
  571676450,588519459,521147423,453446683,554504737,537661728,739777836,
  487396381,605034788,789715759,873732916,688986153,722540843,688985897,
  571479330,638589222,571019554,1293953869,2134397823,772872750,537727776,
  571742498,571414562,604837412,672209448,638523430,689052457,773135662,
  773135662,655234599,773135662,1277110092,1092165697,924130359,722540075,
  672538408,756490285,806624816,873537076,621482533,823730225,605099812,
  639179558,419894809,638260518,857152307,672603432,672144424,756293421,
  789781807,756029741,772742702,604968740,588387619,638456102,1797536619,
  1832010861,923868215,470289692,655366439,537596704,470487324,504370462,
  537596704,537596704,588125731,537596704,571413794,554570785,520884767,
  520884767,588519203,521147423,571413282,604902180,554636577,588190755,
  571282978,520886047,505027870,973607482,-1808050796,654972711,638785830,
  706157866,638785830,638785830,571413794,537727776,621942821,571413794,
  537859360,571545378,554702369,689446441,840639538,705895466,689052457,
  689052457,672208168,806952240,773266222,874324276,705697578,756292653,
  722738475,487133981,689250089,689118249,756292653,756226605,672537640,
  672471848,655628839,655628839,554504737,571347746,672405800,655562791,
  170333450,1193685319,1730297447,604180772,604706340,554374177,504173342,
  504436510,504304414,420089369,554833441,470618396,453775387,504304414,
  436932378,521147423,470749724,470815260,521081631,537859104,537859360,
  554636577,554571297,571349026,839391282,1967675253,856628019,520819999,
  588256803,621942821,554570785,554570785,638785830,706157866,672471848,
  571413794,605099812,621942821,689314857,672471848,722738475,672209448,
  722738475,689052457,672273960,722802987,705959978,773332014,1025714749,
  773135662,689052457,605035044,621680421,689052457,689052457,705763626,
  605099812,638785830,638785830,571413794,706091818,554504737,689248809,
  621876773,1158617925,1074402880,1276913740,1395340627,537202464,537465376,
  588256803,487527453,504304414,403246360,504304414,521147423,352717333,
  453775387,453775387,453841179,487592221,521212703,537924384,537924640,
  554701857,604968484,688986409,924459831,1881292656,906434102,605230628,
  689052457,571413794,571413794,621942821,655628839,638785830,621942821,
  504041758,588256803,722802987,689116969,773332014,705959978,621680421,
  638523430,722738475,689052457,689248809,655562791,638719782,621876773,
  739383596,604705572,638523430,571349026,655102759,806755632,621680421,
  621878053,621942821,689314857,672537896,621942821,689248809,503975710,
  689248809,672405800,-1000637500,-1536658268,705827370,822940209,1143418948,
  672011560,537661728,504172574,571676450,470618396,453775387,453775387,
  352717333,420089369,470618396,420089369,453971995,487658269,487658525,
  521147423,772806702,890379573,1041441342,1259874379,874322740,-1873651056,
  -897807414,789320239,672471848,605099812,655628839,638785830,655628839,
  571413794,537727776,520884767,840638258,756423213,655365159,739580204,
  655366439,604837412,655366439,672209448,520884767,571413794,739843884,
  655628839,890970677,789978671,621680421,655564071,907418166,975119674,
  554374177,571612962,638851622,638786086,622008613,622008613,605033764,
  604968228,588190755,655562791,704645418,806360880,571479074,638916646,
  705368874,840375858,655365159,638850854,453775387,487461405,487461405,
  470618396,487461405,420089369,436998170,369691670,470552604,520950559,
  604902692,638457382,1243425610,1394684499,1478570840,1041308990,840244530,
  1513700442,1766345833,604705572,453447963,436604954,588192035,655564071,
  453908251,554834465,470553372,638785830,689446441,588388387,521016351,
  622008869,537727776,621942821,571413794,605099812,621942821,756686893,
  706157866,571413794,571019554,688920617,705763626,722606635,789912623,
  857350707,605035044,588323363,622074661,655760167,605100068,638720550,
  554636065,554636577,554571041,571413794,605231652,537859360,554636833,
  504173342,554570785,554504737,891298869,672142120,252316431,370020630,
  369626390,520819487,571676194,470618396,420089369,487395869,537793312,
  756095277,940909112,1092167489,1495348569,1545746012,1461465943,1007821628,
  857284915,789649199,873666612,722738475,554506017,571349026,537663008,
  537663008,521148447,403181080,588388131,706157610,487395869,554702369,
  571610914,504107806,554570785,605099812,588256803,605099812,605099812,
  689314857,621942821,571413794,621680421,689052457,638523430,621680421,
  756292653,655366695,554637601,655695399,790503983,807215408,689314857,
  621811493,588322339,571413794,554570785,537727776,521016095,487395613,
  487264541,453644571,453841691,537661984,571347746,790175023,504370462,
  487527197,521081631,453578523,453840923,403246616,453841179,420089881,
  504173598,823205681,1192897863,1377710418,1562589277,1495283033,1327116111,
  890643509,773267758,722474795,638325542,504043294,520820255,605035044,
  554506017,571349026,453710363,622140197,655497255,672339496,537793568,
  521016607,504107550,504173598,571479586,571413794,605099812,621942821,
  571413794,605099812,588191011,605099812,503976990,571349026,571349026,
  621878053,655563559,504108830,571480354,807346736,908404022,942024248,
  874390068,689249065,621811749,605034020,537728288,537596960,521081631,
  520950303,487395869,487330333,453775899,436867354,537727520,638588966,
  857088051,638391846,520819487,453906715,470684188,436932378,487395613,
  470618652,520885023,873734196,1344090448,1545746524,1528903259,1394553683,
  1175988550,823271473,621813029,688921385,689052201,470620700,554571809,
  571283234,588192035,588192035,672471848,655628839,672339752,689116969,
  554571041,537859360,554571553,537859360,605099556,554570785,621877285,
  621942821,520885279,605099812,605099812,638785830,571415074,571415074,
  504043038,537729056,520754719,504174110,689446953,891627061,958933049,
  1026107453,975578682,857612595,689314089,655365927,605099812,621811493,
  588191011,537858848,504238622,521016095,436998938,436933402,504173342,
  504042270,789519151,789585199,487461917,403575064,419958041,504173342,
  470618140,453841435,504173598,940777528,1444819286,1612921440,1360867409,
  1226583625,957687353,756030509,604904484,621812261,672209448,521017631,
  571415330,571283490,571283490,638589990,588717603,521016863,655497255,
  722802987,605034276,554768417,588388131,588256803,588322339,588191011,
  638654246,672340264,554571553,621811493,554636833,554505761,571151650,
  554177313,739450412,705764394,520886047,588454691,773989166,925378359,
  975775546,1059727935,1042884414,941892664,824057649,789912879,773200942,
  722803243,638654246,571544866,521147167,504304158,487461661,521016607,
  504108062,537662496,688723753,705829418,554768161,487330589,403312920,
  453907483,453775899,453775131,487395869,924131383,1344286544,1394552915,
  1109010498,1041704510,823271217,672078376,604903716,537795104,554703393,
  554506529,521017375,587995171,604903972,672275752,504174622,521082399,
  638719782,739580204,638720038,571676706,622008613,621877285,604968484,
  638588966,655431463,672274984,588125731,588126243,571348770,554571297,
  790045231,588060963,621615397,672144424,521213727,656154407,841360434,
  958932537,992552763,1076636224,1042950462,958801977,891429685,840835378,
  756555309,689314345,638785574,571610402,537989920,521147167,521082143,
  521147679,521016351,604968484,672143656,655431975,588256547,537662496,
  504108318,420089881,470552348,470683676,436932378,789715247,957817913,
  1041769534
};


struct particleinfo
{
  float x;
  float y;
  float z;
  float sx;
  float sy;
  float sz;
  float ax;
  float ay;
  float az;
  float m;
  float delay;
  float rotx;
  float srotx;
  SoSeparator *p;
  SoRotation *rot;
  SoTransform *xf;
  SoText3 * t;
  particleinfo()
  {
    x=y=z=sx=sy=sz=ax=ay=az=m=delay=rotx=srotx=0.0f;
    p=NULL; xf=NULL; t=NULL;
  };
};

int num_particles;
particleinfo *particles;

SbViewportRegion vp;

SoSeparator * root;
SoPerspectiveCamera * camera;
SoSeparator * logo;
SoRotation * logorot;

SbTime lasttime;
SbTime starttime;

SbBool firstletter;

float speedjitter = 0.5;

double flexrand(double lower, double upper)
{
  return lower + ((double)rand()/(double)RAND_MAX)*(upper-lower);
};

static void timerSensorCallback(void *data, SoSensor *)
{
  SbTime now = SbTime::getTimeOfDay();
  SbTime timediff = now-lasttime;
  lasttime = now;
  double diff = timediff.getValue(); // time in seconds
  SbTime stimediff = now-starttime;
  double sdiff = stimediff.getValue();
  int leader = 0;

  // rotate logo
  logorot->rotation.setValue(SbVec3f(0.0f, 1.0f, 0.0f), sdiff*2*3.14*0.1);

  // print text

  SbTime letterdiff = now-lastlettertime;
  double ldiff = letterdiff.getValue();
  if (ldiff>TEXTDELAY) {
    // print a new letter
    
    char tt[2];
    tt[1] = 0;
    tt[0] = text2[textpos];
    particles[currpart].t->string.setValue(tt);


    if (spos==0) {
      particles[currpart].x=XPOS;
    }
    else
      {
	SoGetBoundingBoxAction bboxa(vp);
	if (currpart==0)
	  {
	    bboxa.apply(particles[NUM_PARTICLES-1].t);
	    SbBox3f bbox = bboxa.getBoundingBox();

	    float w, h, d;
	    bbox.getSize(deltax,h,d);
	    particles[currpart].x=particles[NUM_PARTICLES-1].x+deltax*0.12f;
	  }
	else
	  {
	    bboxa.apply(particles[currpart-1].t);
	    SbBox3f bbox = bboxa.getBoundingBox();

	    float w, h, d;
	    bbox.getSize(deltax,h,d);
	    particles[currpart].x=particles[currpart-1].x+deltax*0.12f;
	  }
      }

    particles[currpart].y=-(float)line*1.5f;
    particles[currpart].z=-0.0f;

    particles[currpart].sx=flexrand(-1.0, 1.0);
    particles[currpart].sy=flexrand(-1.0, 1.0);
    particles[currpart].sz=10.0f;

    particles[currpart].srotx=2.0f;
    particles[currpart].rotx=0.0f;

    particles[currpart].delay = sdiff+FALLDELAY;

    particles[currpart].xf->translation.setValue(particles[currpart].x, 
						 particles[currpart].y, particles[currpart].z);

    particles[currpart].rot->rotation.setValue(SbVec3f(0.0f, 1.0f, 0.0f), particles[currpart].rotx);


    spos++;
    if ( ((text2[textpos] == ' ') && (spos>=LINE_BREAK))
	 || (text2[textpos] == '\n'))
      {
	line++;
	line %= NUM_LINES;
	spos=0;
      }


    textpos++;
    textpos%=textlen;

    currpart++;
    currpart %= NUM_PARTICLES;

    lastlettertime=now;


  }

  int i;

  // animate particles

  for (i=0; i<num_particles; i++)
    {
      if (sdiff-particles[i].delay<0)
	continue;
      particles[i].x+=diff*particles[i].sx;
      particles[i].y+=diff*particles[i].sy;
      particles[i].z+=diff*particles[i].sz;

      particles[i].sx+=diff*particles[i].ax;
      particles[i].sy+=diff*particles[i].ay;
      particles[i].sz+=diff*particles[i].az;

      particles[i].rotx+=diff*particles[i].srotx;

      float bound = 12.0;
      float absorb = 0.65;

      if (particles[i].y<-bound)
	{
	  particles[i].sy=1.0*fabs(particles[i].sy)*absorb;
	  particles[i].sx += speedjitter*(rand()%100)/100.0;
	  particles[i].sy += speedjitter*(rand()%100)/100.0;
	}


      if (particles[i].y>bound)
	particles[i].sy=-1.0*fabs(particles[i].sy)*absorb;

      /*    if (particles[i].x<-bound)
	    particles[i].sx=1.0*fabs(particles[i].sx)*absorb;

	    if (particles[i].x>bound)
	    particles[i].sx=-1.0*fabs(particles[i].sx)*absorb;
      */

      float sbound = 50;
  
      if (particles[i].sx>sbound)
	particles[i].sx = sbound;
      if (particles[i].sx<-sbound)
	particles[i].sx = -sbound;

      if (particles[i].sy>sbound)
	particles[i].sy = sbound;
      if (particles[i].sy<-sbound)
	particles[i].sy = -sbound;

      particles[i].xf->translation.setValue(particles[i].x, particles[i].y, particles[i].z);
      particles[i].rot->rotation.setValue(SbVec3f(0.0f, 1.0f, 0.0f), particles[i].rotx);
    }
}


SoSeparator * create_logo(SoTexture2 * texture)
{
  SoSeparator * sep = new SoSeparator;
  sep->ref();

  SoMaterial * mat = new SoMaterial;
  mat->specularColor.setValue( 1.0f, 3.0f, 1.0f );
  mat->emissiveColor.setValue( 1.0f, 1.0f, 5.0f );
  mat->diffuseColor.setValue( 1.0f, 5.0f, 1.0f );
  mat->shininess = 0.8f;
  mat->transparency = 0.7f;

  sep->addChild(mat);

  sep->addChild(new SoTextureCoordinateEnvironment);
  sep->addChild(texture);

  SoTranslation * trans = new SoTranslation;
  trans->translation.setValue(-2.0f, -2.5f, 0.2f);
  sep->addChild(trans);

  SoScale * scale = new SoScale;
  scale->scaleFactor.setValue(0.6f, 0.7f, 0.6f);
  sep->addChild(scale);
	
  // C
  SoText3 * c = new SoText3;
  c->string.setValue( "C" );
  c->parts.setValue( SoText3::ALL );
  sep->addChild(c);

  SoSeparator * separator = new SoSeparator;

  // O
  SoTranslation * trans_o = new SoTranslation;
  trans_o->translation.setValue(1.75f, 2.5f, 0.0f);
  separator->addChild(trans_o);

  SoScale * scale_o = new SoScale;
  scale_o->scaleFactor.setValue(0.57f, 0.57f, 1.0f);
  separator->addChild(scale_o);

  SoText3 * o = new SoText3;
  o->string.setValue( "O" );
  o->parts.setValue( SoText3::ALL );
  separator->addChild(o);

  // I
  SoTranslation * trans_i = new SoTranslation;
  trans_i->translation.setValue(2.5f, 1.1f, 0.0f);
  separator->addChild(trans_i);

  SoScale * scale_i = new SoScale;
  scale_i->scaleFactor.setValue(0.7f, 0.7f, 1.0f);
  separator->addChild(scale_i);

  SoText3 * i = new SoText3;
  i->string.setValue( "I" );
  i->parts.setValue( SoText3::ALL );
  separator->addChild(i);

  // N
  SoTranslation * trans_n = new SoTranslation;
  trans_n->translation.setValue(-0.8f, -6.3f, 0.0f);
  separator->addChild(trans_n);

  SoScale * scale_n = new SoScale;
  scale_n->scaleFactor.setValue(0.6f, 0.6f, 1.0f);
  separator->addChild(scale_n);

  SoText3 * n = new SoText3;
  n->string.setValue( "N" );
  n->parts.setValue( SoText3::ALL );
  separator->addChild(n);

  // separator
  sep->addChild(separator);

  // top
  SoTranslation * trans_t = new SoTranslation;
  trans_t->translation.setValue(3.6f, -0.9f, -0.5f);
  sep->addChild(trans_t);

  SoScale * scale_t = new SoScale;
  scale_t->scaleFactor.setValue(0.2f, 0.8f, 0.5f);
  sep->addChild(scale_t);

  SoCube * t = new SoCube;
  sep->addChild(t);

  // bottom
  SoTranslation * trans_b = new SoTranslation;
  trans_b->translation.setValue(0.0f, 11.4f, 0.0f);
  sep->addChild(trans_b);

  SoCube * b = new SoCube;
  sep->addChild(b);

  sep->unrefNoDelete();
	
  return sep;
}

SoTexture2 *
create_texture(int width, int height, int bpp, unsigned char * raw, bool blend)
{
  SoTexture2 * texture = new SoTexture2;
  texture->image.setValue(SbVec2s(width, height), bpp, raw);
  texture->model = (blend?SoTexture2::BLEND:SoTexture2::DECAL);
  texture->blendColor.setValue(1.0, 0.0, 0.0);
  return texture;
}

int
main(
     int argc,
     char ** argv )
{

  textpos = 0;
  currpart = 0;
  firstletter = true;

  @WIDGET@ window = So@Gui@::init(argv[0]);
  if (window == NULL) exit(1);

  vp.setWindowSize(SbVec2s(400, 400));


  root = new SoSeparator;
  root->ref();
  root->addChild( camera = new SoPerspectiveCamera );
  root->addChild( new SoDirectionalLight );

  SoShapeHints * hints = new SoShapeHints;
  hints->vertexOrdering = SoShapeHints::COUNTERCLOCKWISE;
  hints->shapeType = SoShapeHints::SOLID;
  hints->creaseAngle = 0.91f;
  root->addChild( hints );

  
  SoSeparator * instructsep = new SoSeparator;
  root->addChild(instructsep);

  SoOrthographicCamera * ocam = new SoOrthographicCamera;
  instructsep->addChild(ocam);

  SoTranslation * instructtrans = new SoTranslation;
  //  instructtrans->translation = SbVec3f(0.0f, -1.0f, 0.0f);
  instructsep->addChild(instructtrans);

  SoText2 * instructions = new SoText2;
  const char * str[] = {
    "","","","","","","","",
    "","","","","","","","",
    "","","","","","","","",
    "","","","","","","","",
    "","","","","","","","",
    "(Press 'q' to exit)."
  };
  instructions->string.setValues(0, sizeof(str) / sizeof(char *), str);
  instructions->justification = SoText2::LEFT;
  instructsep->addChild(instructions);

  logo = new SoSeparator;
  SoTransform *logoxf;
  logo->addChild(logoxf = new SoTransform);
  logoxf->translation.setValue(SbVec3f(4.0f, -2.0f, 25.0f));
  logo->addChild(logorot = new SoRotation);
  logo->addChild(create_logo(create_texture(64,64,4,(unsigned char*)envq_raw,true)));
  root->addChild(logo);
  
  SoBaseColor * basecol = new SoBaseColor;
  basecol->rgb.setValue( float(rand())/float(RAND_MAX),
                         float(rand())/float(RAND_MAX),
                         float(rand())/float(RAND_MAX) );
  root->addChild( basecol );

  textlen = strlen(text2);
  char tt[2];
  tt[1] = 0;

  num_particles = NUM_PARTICLES;
  particles = new particleinfo[num_particles];

  SoSphere *ball;
  SoSeparator *textsep = new SoSeparator;
  root->addChild(textsep);

  int i;
  srand( (unsigned)time( NULL ) );
  line=0;
  spos=0;

  deltax=0.0f;
  textpos = 0;
  // add empty text
  for (i=0; i<num_particles; i++)
    {
      particles[i].ax=0.0;
      particles[i].ay=-9.8f*2.0f;
      particles[i].az=-4.0f*2.0f;

      particles[i].delay = -100.0f;

      textsep->addChild(particles[i].p = new SoSeparator);
      particles[i].p->addChild(particles[i].xf = new SoTransform);

      particles[i].p->addChild(particles[i].rot = new SoRotation);

      SoScale * s = new SoScale;
      s->scaleFactor.setValue(0.1f, 0.1f, 0.1f);
      particles[i].p->addChild(s);

      particles[i].t = new SoText3;
      tt[0] = ' ';
      particles[i].t->string.setValue(tt);
      //	  particles[i].t->parts.setValue(SoText3::FRONT);
      particles[i].t->parts.setValue(SoText3::ALL);
      particles[i].t->justification=SoText3::LEFT;
      particles[i].p->addChild(particles[i].t);

    };

  lastlettertime = SbTime::getTimeOfDay();

  //   SoWinExaminerViewer *viewer = new SoWinExaminerViewer(window);
  So@Gui@ExaminerViewer * viewer = new So@Gui@ExaminerViewer(window);

#ifdef HAVE_SOGLRENDERACTION_SORTED_OBJECT_SORTED_TRIANGLE_BLEND
  viewer->setTransparencyType( SoGLRenderAction::SORTED_OBJECT_SORTED_TRIANGLE_BLEND );
#else // !HAVE_SOGLRENDERACTION_SORTED_OBJECT_SORTED_TRIANGLE_BLEND
  viewer->setTransparencyType( SoGLRenderAction::SORTED_OBJECT_BLEND );
#endif // !HAVE_SOGLRENDERACTION_SORTED_OBJECT_SORTED_TRIANGLE_BLEND

  viewer->setSceneGraph( root );

  viewer->setViewportRegion(vp);
  camera->viewAll(logo, vp);
  float x,y,z;
  SbVec3f cpos;
  cpos = camera->position.getValue();
  cpos.getValue(x, y, z);
  //  camera->position.setValue(x, y, z-10.0f);
  camera->nearDistance = 1.0;
  camera->farDistance = 100.0;
  SoTimerSensor *timerSensor;
  timerSensor = new SoTimerSensor(timerSensorCallback, NULL);
  timerSensor->setInterval(SbTime(0, 1000*10));
  timerSensor->schedule();

  lasttime = SbTime::getTimeOfDay();
  starttime = lasttime;

  viewer->setDecoration(FALSE);
  viewer->show();
  So@Gui@::show( window );

#ifdef HAVE_SOCOMPONENT_SETFULLSCREEN
  // Must do this _after_ show() to avoid the "Start"-bar being
  // visible with SoWin. (Bug!)
  (void)viewer->setFullScreen(TRUE);
#endif // HAVE_SOCOMPONENT_SETFULLSCREEN


  So@Gui@::mainLoop();

  root->unref();

  delete [] particles;

  return 0;
} // main()

